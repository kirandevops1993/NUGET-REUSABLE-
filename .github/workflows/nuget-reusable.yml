name: Dotnet Reusable Workflow

on:
  workflow_call:
    inputs:
      commands:
        required: true
        type: string

jobs:
  dotnet:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        command: ${{ fromJson(inputs.commands) }}
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: 8.0.x

      - name: Run ${{ matrix.command }}
        run: |
          CMD="${{ matrix.command }}"
          if [ "$CMD" = "restore" ]; then
            dotnet restore "**/*.csproj" --configfile "NuGet.config"
          elif [ "$CMD" = "build" ]; then
            dotnet build "**/*.csproj" --configuration Release
          else
            echo "Unsupported command: $CMD"
            exit 1
          fi
        shell: bash
